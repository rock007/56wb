<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>	
	<title>新增、编辑</title>
	<link href="../plugins/bootstrap/bootstrap.min.css" rel="stylesheet" />
	<link href="../css/site.css" rel="stylesheet" />
		
</head>
<body>

<div th:replace="fragments/header::header"></div>

<div class="container" style="padding-top: 55px;" >
	
	<div class="row">
		<form  action="submit-blog-edit.action" role="form" method="post" id="blog_edit_form">
		<div class="col-xs-12">
			 <div class="form-group">
				<input type="text" name="title" id="title" maxlength="100" class="form-control"/>
			</div>
		
			<iframe id="editor" style="width:100%; height:450px;"  onload="top.editor=this.contentWindow.editor"  src="../plugins/squire/document.html"></iframe>
			
			<div class="form-group">			
				<input type="hidden" name="content" id="content"/>
			</div>
		</div>		
		<div class="col-xs-12 text-center">
		
			<input type="hidden" name="id" />
		
			<input type="hidden" name="createUser" value="sam"/>
			
			<input type="submit" class="btn btn-default" value="发布" />
	
			<input type="submit" class="btn btn-default" value="保存" />
	
		</div>
		</form>	
	</div>
	
</div>	

<div th:include="fragments/footer::footer">footer</div>
 
<script src="../plugins/jquery/jquery.min.js"></script>
<script src="../plugins/bootstrap/bootstrap.min.js"></script>

<script src="../js/site.js"></script>

<script type="text/javascript" src="../plugins/bootstrapvalidator/bootstrapValidator.min.js"></script>
<script type="text/javascript" src="../plugins/bootstrapvalidator/language/zh_CN.js"></script>
	
<script th:inline="javascript">
/*<![CDATA[*/
           
function formValidator(){
	
	$('#blog_edit_form').bootstrapValidator({
		message: '输入信息验证不通过',
		fields: {
			title: {
				message: '标题信息输入不正确！',
				validators: {
					notEmpty: {
						message: '标题不能为空！'
					},
					stringLength: {
						min: 2,
						max: 100,
						message: '标题不能小于2个字，也不能大于100个字！'
					}
				}
			},
			content: {
				validators: {
					notEmpty: {
						message: '内容不能为空！'
					}
				}
			}
		}
	}).on('success.form.bv', function(e) {
        e.preventDefault();
       
        var editor=$('#editor')[0].contentWindow.editor;
        
        $("#content").val(editor.getHTML());
                
   	  	$.ajax({
          url: $(this).attr('action'),
          type: 'POST',
          data: $(this).serialize(),
          success: function(result) {
          	console.log(result);

              if(result.success){
              	
            	  go2page(result.data);
              	
              }else{
              	 message(result.msg);
              }
          }
      });
    });
}

	$(function(){
		
		formValidator();
		
		$("#btn_test").click(function(){
			
			var editor=$('#editor')[0].contentWindow.editor;
			
		 	console.log( editor.getHTML());
			
		});
	});
/*]]>*/
</script>

</body>
</html>